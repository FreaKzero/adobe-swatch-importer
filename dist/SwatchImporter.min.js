/*! adobe-swatch-importer 1.0.0 Copyright (C) 2015, Thomas Petrovic <pete@freakzero.com> 
 Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license */
define(function(){function a(a){this.name="wrongFormatError",this.message=a||"",this.consoleoutput="["+this.name+"] "+this.message}function b(a){function b(a){return null===a?"00":(a=parseInt(a),0===a||isNaN(a)?"00":(a=Math.max(0,a),a=Math.min(a,255),a=Math.round(a),"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)))}return"#"+b(a[0])+b(a[1])+b(a[2])}function c(){this.version,this.amount=0,this.colors=[],this.converted=!1,this.byteIndex=0,this.error=!1}function d(a){switch(a){case"aco":return new f;case"ase":return new c}}a.prototype=Error.prototype;var e=function(a){this.swatchType=a,this.name,this.origin,this.originFormat,this.rgb,this.hash};e.prototype.rgb=function(a,c,d,e){this.name=a,this.originFormat=this.swatchType.toUpperCase()+" RGB",this.origin=[c,d,e,0],"aco"===this.swatchType?this.rgb=[Math.floor(c/257),Math.floor(d/257),Math.floor(e/257)]:"ase"===this.swatchType&&(this.rgb=[256*c,256*d,256*e]),this.hash=b(this.rgb)},e.prototype.cmyk=function(a,c,d,e,f){var g;this.name=a,this.originFormat=this.swatchType.toUpperCase()+" CMYK",this.origin=[c,d,e,f],"aco"===this.swatchType?(g=1-f/65535,this.rgb=[255*(1-(1-c/65535))*(1-g),255*(1-(1-d/65535))*(1-g),255*(1-(1-e/65535))*(1-g)]):"ase"===this.swatchType&&(g=255*f,this.rgb=[255*(1-c)*(1-g),255*(1-d)*(1-g),255*(1-e)*(1-g)]),this.hash=b(this.rgb)},e.prototype.hsb=function(a,c,d,e){function f(a,b,c){a=Math.floor(a/65535*360)/360,b=Math.floor(b/65535*100)/100,c=Math.floor(c/65535*100)/100;var d,e,f,g,h,i,j,k;switch(a&&void 0===b&&void 0===c&&(b=a.s,c=a.v,a=a.h),g=Math.floor(6*a),h=6*a-g,i=c*(1-b),j=c*(1-h*b),k=c*(1-(1-h)*b),g%6){case 0:d=c,e=k,f=i;break;case 1:d=j,e=c,f=i;break;case 2:d=i,e=c,f=k;break;case 3:d=i,e=j,f=c;break;case 4:d=k,e=i,f=c;break;case 5:d=c,e=i,f=j}return[Math.floor(255*d),Math.floor(255*e),Math.floor(255*f)]}this.name=a,this.originFormat=this.originFormat=this.swatchType.toUpperCase()+"HSB",this.origin=[c,d,e],this.rgb=f(c,d,e),this.hash=b(this.rgb)};var f=function(){this.version,this.amount=0,this.colors=[],this.converted=!1,this.byteIndex=0,this.error=!1};return f.prototype._readHead=function(b){try{var c=b.getInt16(2),d=10*c+5;if(2!==b.getInt8(d))throw this.error=!0,new a("Given binary data is not in an valid ACO Format");this.amount=c,this.byteIndex=10*c+9}catch(e){throw this.error=!0,new a("Given binary data is not in an valid ACO Format")}return!0},f.prototype.getColorSpace=function(a){var b={0:"RGB",1:"HSB",2:"CMYK",3:"PANTONE",4:"FOCOLTONE",5:"TRUMATCH",6:"TOYO88",7:"LAB",8:"GREYSCALE",10:"HKS"};return"undefined"!=typeof b[a]?b[a]:"INVALID COLORSPACE BYTE ["+a+"]"},f.prototype.getColors=function(a){var b;try{this._readHead(a);for(var c=0;c<this.amount;c++){b=this.byteIndex;var d=null,f=this.getColorSpace(a.getInt8(b)),g=2*a.getInt32(b+9),h=a.getString(g,b+12);switch(f){case"RGB":d=new e("aco"),d.rgb(h,a.getUint16(b+1),a.getUint16(b+3),a.getUint16(b+5));break;case"CMYK":d=new e("aco"),d.cmyk(h,a.getUint16(b+1),a.getUint16(b+3),a.getUint16(b+5),a.getUint16(b+7));break;case"HSB":d=new e("aco"),d.hsb(h,a.getUint16(b+1),a.getUint16(b+3),a.getUint16(b+5));break;default:console.log("Colorspace "+f+" not supported - skipping Color")}null!==d&&this.colors.push(d),this.byteIndex=this.byteIndex+g+14}return this.colors}catch(i){throw console.error(i.consoleoutput),i}},c.prototype._readHead=function(b){try{var c=b.getString(4,0);if(this.version=b.getUint16(4)+b.getUint16(6),this.amount=b.getUint32(8),this.byteIndex=16,"ASEF"!==c)throw this.error=!0,new a("Given binary data is not in an valid ASE Format")}catch(d){throw this.error=!0,new a("Given binary data is not in an valid ASE Format")}},c.prototype.getColors=function(a){var b;try{this._readHead(a);for(var c=0;c<this.amount;c++){var d=null;b=this.byteIndex;var f=a.getUint16(b),g=2*a.getUint16(b+2);b+=4;var h=a.getString(g,b),i=a.getString(4,b+g).trim();switch(b=b+g+4,i){case"RGB":d=new e("ase"),d.rgb(h,a.getFloat32(b),a.getFloat32(b+4),a.getFloat32(b+8));break;case"CMYK":d=new e("ase"),d.cmyk(h,a.getFloat32(b),a.getFloat32(b+4),a.getFloat32(b+8),a.getFloat32(b+10))}null!==d&&this.colors.push(d),this.byteIndex=this.byteIndex+f+6}return this.colors}catch(j){throw console.error(j.consoleoutput),j}},d});
//# sourceMappingURL=SwatchImporter.map